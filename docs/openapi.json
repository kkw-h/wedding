{"openapi":"3.1.0","info":{"title":"Wedding SaaS API","version":"1.0.0"},"paths":{"/api/v1/auth/login/access-token":{"post":{"tags":["auth"],"summary":"Login Access Token","description":"OAuth2 兼容的 Token 登录接口，获取 Access Token","operationId":"login_access_token_api_v1_auth_login_access_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_access_token_api_v1_auth_login_access_token_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/register":{"post":{"tags":["auth"],"summary":"Register","description":"注册新用户","operationId":"register_api_v1_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users/me":{"get":{"tags":["users"],"summary":"Read User Me","description":"Get current user.","operationId":"read_user_me_api_v1_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRead"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/users/":{"get":{"tags":["users"],"summary":"Read Users","description":"Retrieve users.","operationId":"read_users_api_v1_users__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"role","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/RoleType"},{"type":"null"}],"title":"Role"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserRead"},"title":"Response Read Users Api V1 Users  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["users"],"summary":"Create User","description":"Create new user.","operationId":"create_user_api_v1_users__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users/{user_id}":{"put":{"tags":["users"],"summary":"Update User","description":"Update a user.","operationId":"update_user_api_v1_users__user_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users/roles":{"get":{"tags":["users"],"summary":"Read Roles","description":"Get all available roles.","operationId":"read_roles_api_v1_users_roles_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"string"},"type":"array","title":"Response Read Roles Api V1 Users Roles Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/permissions/sync":{"post":{"tags":["permissions"],"summary":"Sync Permissions Db","description":"Force sync permissions from code to DB. (Admin only)","operationId":"sync_permissions_db_api_v1_permissions_sync_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/permissions/":{"get":{"tags":["permissions"],"summary":"List Permissions","operationId":"list_permissions_api_v1_permissions__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/PermissionRead"},"type":"array","title":"Response List Permissions Api V1 Permissions  Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/leads/":{"get":{"tags":["leads"],"summary":"Read Leads","description":"获取线索列表。\n- ADMIN/MANAGER: 获取所有线索\n- PLANNER: 仅获取自己负责的线索","operationId":"read_leads_api_v1_leads__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LeadResponse"},"title":"Response Read Leads Api V1 Leads  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["leads"],"summary":"Create Lead","description":"创建新线索。\n自动检测手机号冲突。","operationId":"create_lead_api_v1_leads__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/leads/{lead_id}":{"get":{"tags":["leads"],"summary":"Read Lead","description":"获取特定线索详情。","operationId":"read_lead_api_v1_leads__lead_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"lead_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Lead Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/":{"get":{"tags":["projects"],"summary":"Read Projects","description":"获取项目列表。\n- ADMIN/MANAGER: 获取所有项目\n- PLANNER: 仅获取自己负责的线索转化成的项目","operationId":"read_projects_api_v1_projects__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProjectResponse"},"title":"Response Read Projects Api V1 Projects  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["projects"],"summary":"Create Project","description":"创建项目 (将线索转化为项目)。","operationId":"create_project_api_v1_projects__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/projects/{project_id}":{"get":{"tags":["projects"],"summary":"Read Project","description":"获取项目详情。","operationId":"read_project_api_v1_projects__project_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["projects"],"summary":"Update Project","description":"更新项目信息。","operationId":"update_project_api_v1_projects__project_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/budgets/project/{project_id}":{"get":{"tags":["budgets"],"summary":"Read Project Budget","description":"获取项目报价单。\n- PLANNER: 仅返回销售价相关字段\n- ADMIN/MANAGER: 返回包含成本价和毛利的完整数据","operationId":"read_project_budget_api_v1_budgets_project__project_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"anyOf":[{"type":"array","items":{"$ref":"#/components/schemas/BudgetItemAdminResponse-Output"}},{"type":"array","items":{"$ref":"#/components/schemas/BudgetItemResponse"}}],"title":"Response Read Project Budget Api V1 Budgets Project  Project Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/budgets/":{"post":{"tags":["budgets"],"summary":"Create Budget Item","description":"创建报价单明细项。","operationId":"create_budget_item_api_v1_budgets__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetItemCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetItemResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/budgets/{item_id}":{"put":{"tags":["budgets"],"summary":"Update Budget Item","description":"更新报价单明细。","operationId":"update_budget_item_api_v1_budgets__item_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Item Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetItemUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetItemResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["budgets"],"summary":"Delete Budget Item","description":"删除报价单明细。","operationId":"delete_budget_item_api_v1_budgets__item_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Item Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetItemResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/approvals/":{"get":{"tags":["approvals"],"summary":"Read Approvals","description":"获取审批列表。\n- PLANNER: 仅看自己发起的\n- MANAGER/ADMIN: 看所有","operationId":"read_approvals_api_v1_approvals__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"status_filter","in":"query","required":false,"schema":{"$ref":"#/components/schemas/ApprovalStatus"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ApprovalResponse"},"title":"Response Read Approvals Api V1 Approvals  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["approvals"],"summary":"Create Approval","description":"发起审批。","operationId":"create_approval_api_v1_approvals__post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApprovalCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApprovalResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/approvals/{approval_id}/process":{"put":{"tags":["approvals"],"summary":"Process Approval","description":"审批处理 (通过/驳回)。\n- 仅 MANAGER/ADMIN 可操作","operationId":"process_approval_api_v1_approvals__approval_id__process_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"approval_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Approval Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApprovalUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApprovalResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/proposals/project/{project_id}":{"post":{"tags":["proposals"],"summary":"Create Proposal","description":"为项目创建新方案 (Plan A / Plan B)。","operationId":"create_proposal_api_v1_proposals_project__project_id__post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["proposals"],"summary":"Read Proposals","description":"获取项目的所有方案。","operationId":"read_proposals_api_v1_proposals_project__project_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProposalResponse"},"title":"Response Read Proposals Api V1 Proposals Project  Project Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/proposals/{proposal_id}":{"get":{"tags":["proposals"],"summary":"Read Proposal","description":"获取方案详情 (含当前草稿数据)。","operationId":"read_proposal_api_v1_proposals__proposal_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proposal_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Proposal Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["proposals"],"summary":"Update Proposal","description":"更新方案 (Auto-Save 接口)。\n前端应定时调用此接口保存 current_data。","operationId":"update_proposal_api_v1_proposals__proposal_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proposal_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Proposal Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/proposals/{proposal_id}/versions":{"post":{"tags":["proposals"],"summary":"Create Version","description":"创建新版本 (Snapshot)。\n用于手动保存节点、发布等。","operationId":"create_version_api_v1_proposals__proposal_id__versions_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proposal_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Proposal Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalVersionCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalVersionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["proposals"],"summary":"Read Versions","description":"获取方案的历史版本列表。","operationId":"read_versions_api_v1_proposals__proposal_id__versions_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proposal_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Proposal Id"}},{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProposalVersionResponse"},"title":"Response Read Versions Api V1 Proposals  Proposal Id  Versions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/proposals/{proposal_id}/restore/{version_id}":{"post":{"tags":["proposals"],"summary":"Restore Version","description":"恢复到指定版本。\nCurrent Draft (current_data) 将被覆盖。","operationId":"restore_version_api_v1_proposals__proposal_id__restore__version_id__post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"proposal_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Proposal Id"}},{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProposalResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/assets/upload":{"post":{"tags":["assets"],"summary":"Upload File","description":"上传文件到对象存储 (MinIO).","operationId":"upload_file_api_v1_assets_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_api_v1_assets_upload_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssetRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/":{"get":{"summary":"Read Root","operationId":"read_root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ApprovalCreate":{"properties":{"project_id":{"type":"string","format":"uuid","title":"Project Id"},"type":{"$ref":"#/components/schemas/ApprovalType"},"current_data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Current Data"}},"type":"object","required":["project_id","type"],"title":"ApprovalCreate"},"ApprovalResponse":{"properties":{"project_id":{"type":"string","format":"uuid","title":"Project Id"},"type":{"$ref":"#/components/schemas/ApprovalType"},"current_data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Current Data"},"id":{"type":"string","format":"uuid","title":"Id"},"requester_id":{"type":"string","format":"uuid","title":"Requester Id"},"approver_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Approver Id"},"status":{"$ref":"#/components/schemas/ApprovalStatus"},"audit_log":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Audit Log"}},"type":"object","required":["project_id","type","id","requester_id","status"],"title":"ApprovalResponse"},"ApprovalStatus":{"type":"string","enum":["PENDING","APPROVED","REJECTED"],"title":"ApprovalStatus","description":"审批状态枚举"},"ApprovalType":{"type":"string","enum":["DISCOUNT","PAYMENT","REFUND"],"title":"ApprovalType","description":"审批类型枚举"},"ApprovalUpdate":{"properties":{"status":{"$ref":"#/components/schemas/ApprovalStatus"},"audit_log":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Audit Log"}},"type":"object","required":["status"],"title":"ApprovalUpdate"},"AssetRead":{"properties":{"filename":{"type":"string","title":"Filename"},"content_type":{"type":"string","title":"Content Type"},"size":{"type":"integer","title":"Size"},"url":{"type":"string","title":"Url"},"id":{"type":"string","format":"uuid","title":"Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["filename","content_type","size","url","id","created_at"],"title":"AssetRead"},"Body_login_access_token_api_v1_auth_login_access_token_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_access_token_api_v1_auth_login_access_token_post"},"Body_upload_file_api_v1_assets_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_file_api_v1_assets_upload_post"},"BudgetItemAdminResponse-Input":{"properties":{"category":{"type":"string","title":"Category"},"name":{"type":"string","title":"Name"},"quantity":{"type":"integer","title":"Quantity","default":1},"unit_price":{"type":"number","title":"Unit Price","default":0.0},"id":{"type":"string","format":"uuid","title":"Id"},"project_id":{"type":"string","format":"uuid","title":"Project Id"},"cost_price":{"type":"number","title":"Cost Price","default":0.0}},"type":"object","required":["category","name","id","project_id"],"title":"BudgetItemAdminResponse"},"BudgetItemAdminResponse-Output":{"properties":{"category":{"type":"string","title":"Category"},"name":{"type":"string","title":"Name"},"quantity":{"type":"integer","title":"Quantity","default":1},"unit_price":{"type":"number","title":"Unit Price","default":0.0},"id":{"type":"string","format":"uuid","title":"Id"},"project_id":{"type":"string","format":"uuid","title":"Project Id"},"cost_price":{"type":"number","title":"Cost Price","default":0.0},"total_sale_price":{"type":"number","title":"Total Sale Price","readOnly":true},"total_cost_price":{"type":"number","title":"Total Cost Price","readOnly":true},"gross_profit":{"type":"number","title":"Gross Profit","readOnly":true}},"type":"object","required":["category","name","id","project_id","total_sale_price","total_cost_price","gross_profit"],"title":"BudgetItemAdminResponse"},"BudgetItemCreate":{"properties":{"category":{"type":"string","title":"Category"},"name":{"type":"string","title":"Name"},"quantity":{"type":"integer","title":"Quantity","default":1},"unit_price":{"type":"number","title":"Unit Price","default":0.0},"project_id":{"type":"string","format":"uuid","title":"Project Id"},"cost_price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cost Price","default":0.0}},"type":"object","required":["category","name","project_id"],"title":"BudgetItemCreate"},"BudgetItemResponse":{"properties":{"category":{"type":"string","title":"Category"},"name":{"type":"string","title":"Name"},"quantity":{"type":"integer","title":"Quantity","default":1},"unit_price":{"type":"number","title":"Unit Price","default":0.0},"id":{"type":"string","format":"uuid","title":"Id"},"project_id":{"type":"string","format":"uuid","title":"Project Id"},"total_sale_price":{"type":"number","title":"Total Sale Price","readOnly":true}},"type":"object","required":["category","name","id","project_id","total_sale_price"],"title":"BudgetItemResponse"},"BudgetItemUpdate":{"properties":{"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"quantity":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Quantity"},"unit_price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Unit Price"},"cost_price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cost Price"}},"type":"object","title":"BudgetItemUpdate"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LeadCreate":{"properties":{"customer_name":{"type":"string","title":"Customer Name"},"phone":{"type":"string","title":"Phone"},"wedding_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Wedding Date"},"budget_min":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Budget Min"},"budget_max":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Budget Max"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"}},"type":"object","required":["customer_name","phone"],"title":"LeadCreate"},"LeadResponse":{"properties":{"customer_name":{"type":"string","title":"Customer Name"},"phone":{"type":"string","title":"Phone"},"wedding_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Wedding Date"},"budget_min":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Budget Min"},"budget_max":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Budget Max"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"},"id":{"type":"string","format":"uuid","title":"Id"},"owner_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Owner Id"},"last_contact_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Contact At"},"status":{"$ref":"#/components/schemas/LeadStatus"}},"type":"object","required":["customer_name","phone","id","status"],"title":"LeadResponse"},"LeadStatus":{"type":"string","enum":["NEW","CONTACTING","VISITED","INTENTIONAL","WON","LOST","PUBLIC_POOL"],"title":"LeadStatus","description":"线索状态枚举\n描述客户从录入到成交/流失的全生命周期"},"PermissionRead":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"code":{"type":"string","title":"Code"},"name":{"type":"string","title":"Name"},"module":{"type":"string","title":"Module"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"}},"type":"object","required":["id","code","name","module"],"title":"PermissionRead"},"ProjectCreate":{"properties":{"name":{"type":"string","title":"Name"},"wedding_date":{"type":"string","format":"date","title":"Wedding Date"},"hotel_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hotel Name"},"total_budget":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Total Budget","default":0},"lead_id":{"type":"string","format":"uuid","title":"Lead Id"}},"type":"object","required":["name","wedding_date","lead_id"],"title":"ProjectCreate"},"ProjectResponse":{"properties":{"name":{"type":"string","title":"Name"},"wedding_date":{"type":"string","format":"date","title":"Wedding Date"},"hotel_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hotel Name"},"total_budget":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Total Budget","default":0},"id":{"type":"string","format":"uuid","title":"Id"},"lead_id":{"type":"string","format":"uuid","title":"Lead Id"},"stage":{"$ref":"#/components/schemas/ProjectStage"}},"type":"object","required":["name","wedding_date","id","lead_id","stage"],"title":"ProjectResponse"},"ProjectStage":{"type":"string","enum":["PREPARING","DESIGNING","EXECUTING","COMPLETED","ARCHIVED"],"title":"ProjectStage","description":"项目阶段枚举"},"ProjectUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"wedding_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Wedding Date"},"hotel_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hotel Name"},"total_budget":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Total Budget"},"stage":{"anyOf":[{"$ref":"#/components/schemas/ProjectStage"},{"type":"null"}]}},"type":"object","title":"ProjectUpdate"},"ProposalCreate":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"project_id":{"type":"string","format":"uuid","title":"Project Id"}},"type":"object","required":["name","project_id"],"title":"ProposalCreate"},"ProposalResponse":{"properties":{"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"id":{"type":"string","format":"uuid","title":"Id"},"project_id":{"type":"string","format":"uuid","title":"Project Id"},"status":{"$ref":"#/components/schemas/ProposalStatus"},"current_data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Current Data"},"created_by":{"type":"string","format":"uuid","title":"Created By"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["name","id","project_id","status","created_by","created_at"],"title":"ProposalResponse"},"ProposalStatus":{"type":"string","enum":["DRAFT","ACTIVE","SELECTED","ARCHIVED"],"title":"ProposalStatus"},"ProposalUpdate":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"status":{"anyOf":[{"$ref":"#/components/schemas/ProposalStatus"},{"type":"null"}]},"current_data":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Current Data"}},"type":"object","title":"ProposalUpdate"},"ProposalVersionCreate":{"properties":{"snapshot_data":{"additionalProperties":true,"type":"object","title":"Snapshot Data"},"change_log":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Change Log"},"tag_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tag Name"},"action_type":{"$ref":"#/components/schemas/VersionActionType","default":"MANUAL_SAVE"},"proposal_id":{"type":"string","format":"uuid","title":"Proposal Id"},"parent_version_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Parent Version Id"}},"type":"object","required":["snapshot_data","proposal_id"],"title":"ProposalVersionCreate"},"ProposalVersionResponse":{"properties":{"snapshot_data":{"additionalProperties":true,"type":"object","title":"Snapshot Data"},"change_log":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Change Log"},"tag_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tag Name"},"action_type":{"$ref":"#/components/schemas/VersionActionType","default":"MANUAL_SAVE"},"id":{"type":"string","format":"uuid","title":"Id"},"proposal_id":{"type":"string","format":"uuid","title":"Proposal Id"},"parent_version_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Parent Version Id"},"editor_id":{"type":"string","format":"uuid","title":"Editor Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["snapshot_data","id","proposal_id","editor_id","created_at"],"title":"ProposalVersionResponse"},"RoleType":{"type":"string","enum":["ADMIN","MANAGER","PLANNER","VENDOR","FINANCE"],"title":"RoleType","description":"用户角色枚举\n用于控制系统权限 (RBAC)"},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type"}},"type":"object","required":["access_token","token_type"],"title":"Token"},"UserCreate":{"properties":{"username":{"type":"string","title":"Username"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active","default":true},"password":{"type":"string","title":"Password"},"roles":{"items":{"$ref":"#/components/schemas/RoleType"},"type":"array","title":"Roles","default":["PLANNER"]}},"type":"object","required":["username","password"],"title":"UserCreate"},"UserRead":{"properties":{"username":{"type":"string","title":"Username"},"is_active":{"type":"boolean","title":"Is Active"},"id":{"type":"string","format":"uuid","title":"Id"},"roles":{"items":{"$ref":"#/components/schemas/RoleType"},"type":"array","title":"Roles","default":[]},"permissions":{"items":{"type":"string"},"type":"array","title":"Permissions","default":[]}},"type":"object","required":["username","is_active","id"],"title":"UserRead"},"UserUpdate":{"properties":{"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"},"password":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Password"},"roles":{"anyOf":[{"items":{"$ref":"#/components/schemas/RoleType"},"type":"array"},{"type":"null"}],"title":"Roles"}},"type":"object","title":"UserUpdate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VersionActionType":{"type":"string","enum":["AUTO_SAVE","MANUAL_SAVE","PUBLISH"],"title":"VersionActionType"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/v1/auth/login/access-token"}}}}}}